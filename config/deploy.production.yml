# Production deployment configuration
# Use: kamal deploy -d production

# Deploy to production server
servers:
  web:
    hosts:
      - 5.6.7.8  # Replace with production server IP

# Host directories that should be created and mounted
directories:
  - production_db:/var/lib/covertext/production/db
  - production_storage:/var/lib/covertext/production/storage

volumes:
  - "/var/lib/covertext/production/db:/rails/db"
  - "/var/lib/covertext/production/storage:/rails/storage"

env:
  clear:
    RAILS_ENV: production
    APP_HOST: covertext.app
    APP_PROTOCOL: https
    SOLID_QUEUE_IN_PUMA: true
  secret:
    - RAILS_MASTER_KEY

# SSL configuration
proxy:
  ssl: true
  host: covertext.app

# No accessories in production - using Digital Ocean managed Postgres
# Database connection via Rails encrypted credentials:
# bin/rails credentials:edit --environment production
# Add: database: { url: "postgres://..." }
