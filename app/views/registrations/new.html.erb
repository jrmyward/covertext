<% content_for :title, "Sign Up - CoverText" %>

<%= render UI::SectionComponent.new(class_name: "min-h-screen flex items-center justify-center", inner_class: "w-full md:w-1/2 mx-auto") do %>
  <%= render UI::CardComponent.new do %>
    <div data-controller="billing-interval" data-billing-interval-monthly-price-value="<%= @plan_info[:monthly_price] %>" data-billing-interval-yearly-price-value="<%= @plan_info[:yearly_price] %>">
      <div>
        <h2 class="text-center text-3xl font-bold text-primary">Create Your Account</h2>
        <p class="mt-2 text-center text-sm text-base-content/60">
          Sign up for the <span class="font-semibold"><%= @plan_info[:name] %> Plan</span>
        </p>

        <!-- Billing Interval Toggle -->
        <div class="mt-4">
          <%= render UI::Form::BillingIntervalToggleComponent.new(
            name: "billing_interval",
            selected: @selected_interval,
            show_badge: true,
            badge_text: "2 months Free",
            data: {
              action: "change->billing-interval#updatePrice"
            }
          ) do |c| %>
            <%= c.with_price_display do %>
              <p class="mt-2 text-center text-2xl font-bold" data-billing-interval-target="priceDisplay">
                <%= @selected_interval == :yearly ? @plan_info[:yearly_price_display] : @plan_info[:monthly_price_display] %>
              </p>
            <% end %>
          <% end %>
        </div>
      </div>

<%= form_with url: signup_path, method: :post, class: "mt-8 space-y-6", data: { turbo: false } do |f| %>
        <%= hidden_field_tag :plan, @selected_plan %>
        <%= hidden_field_tag :interval, @selected_interval, data: { billing_interval_target: "intervalField" } %>

        <!-- Account Details -->
        <div class="form-control">
          <label class="label text-neutral text-base font-semibold pb-1">
            <span class="label-text">Account Name</span>
          </label>
          <%= text_field_tag :account_name, params[:account_name], class: "input input-bordered w-full", required: true, placeholder: "Reliable Insurance Group", autocomplete: "organization" %>
          <p class="mt-1 text-xs text-base-content/60">Your company or organization name</p>
        </div>

        <!-- Agency Details -->
        <div class="form-control">
          <label class="label text-neutral text-base font-semibold pb-1">
            <span class="label-text">Agency Name</span>
          </label>
          <%= text_field_tag :agency_name, params[:agency_name], class: "input input-bordered w-full", required: true, placeholder: "Downtown Office", autocomplete: "off" %>
          <p class="mt-1 text-xs text-base-content/60">Location or branch name</p>
        </div>

        <div>
          <%= submit_tag "Continue to Payment", class: "btn btn-primary w-full btn-lg" %>
        </div>

        <div class="text-center text-sm">
          <p class="text-base-content/60">
            You'll enter your contact info and payment details on the next screen.
            Cancel anytime.
          </p>
          <p class="mt-2">
            <%= link_to "â† Back to Homepage", root_path, class: "link link-primary" %>
          </p>
        </div>
      <% end %>
    </div>
  <% end %>
<% end %>
